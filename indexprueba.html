<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Calculadora de Algoritmos de Planificaci√≥n</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            background: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
            padding: 30px;
            backdrop-filter: blur(10px);
        }

        h1 {
            text-align: center;
            color: #2c3e50;
            margin-bottom: 30px;
            font-size: 2.5rem;
            font-weight: 600;
        }

        .algorithm-selector {
            display: flex;
            justify-content: center;
            flex-wrap: wrap;
            gap: 15px;
            margin-bottom: 30px;
        }

        .algorithm-btn {
            padding: 12px 24px;
            background: linear-gradient(45deg, #3498db, #2980b9);
            color: white;
            border: none;
            border-radius: 25px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 500;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(52, 152, 219, 0.3);
        }

        .algorithm-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(52, 152, 219, 0.4);
        }

        .algorithm-btn.active {
            background: linear-gradient(45deg, #e74c3c, #c0392b);
            box-shadow: 0 4px 15px rgba(231, 76, 60, 0.3);
        }

        .input-section {
            background: #f8f9fa;
            padding: 25px;
            border-radius: 15px;
            margin-bottom: 30px;
            border: 2px solid #e9ecef;
        }

        .input-row {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
            gap: 15px;
            margin-bottom: 15px;
            align-items: center;
        }

        .input-group {
            display: flex;
            flex-direction: column;
        }

        label {
            font-weight: 600;
            color: #2c3e50;
            margin-bottom: 5px;
            font-size: 14px;
        }

        input[type="number"], input[type="text"] {
            padding: 10px;
            border: 2px solid #ddd;
            border-radius: 8px;
            font-size: 14px;
            transition: border-color 0.3s ease;
        }

        input:focus {
            outline: none;
            border-color: #3498db;
            box-shadow: 0 0 0 3px rgba(52, 152, 219, 0.1);
        }

        .process-list {
            margin-top: 20px;
        }

        .process-item {
            background: white;
            padding: 15px;
            border-radius: 10px;
            margin-bottom: 10px;
            border-left: 4px solid #3498db;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
        }

        .controls {
            display: flex;
            gap: 15px;
            justify-content: center;
            margin-bottom: 30px;
            flex-wrap: wrap;
        }

        .btn {
            padding: 12px 30px;
            border: none;
            border-radius: 25px;
            cursor: pointer;
            font-size: 16px;
            font-weight: 600;
            transition: all 0.3s ease;
            min-width: 140px;
        }

        .btn-primary {
            background: linear-gradient(45deg, #27ae60, #229954);
            color: white;
            box-shadow: 0 4px 15px rgba(39, 174, 96, 0.3);
        }

        .btn-secondary {
            background: linear-gradient(45deg, #f39c12, #e67e22);
            color: white;
            box-shadow: 0 4px 15px rgba(243, 156, 18, 0.3);
        }

        .btn-danger {
            background: linear-gradient(45deg, #e74c3c, #c0392b);
            color: white;
            box-shadow: 0 4px 15px rgba(231, 76, 60, 0.3);
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(0, 0, 0, 0.2);
        }

        .results {
            background: #fff;
            padding: 25px;
            border-radius: 15px;
            margin-top: 30px;
            border: 2px solid #e9ecef;
        }

        .algorithm-title {
            text-align: center;
            color: #c0392b;
            font-size: 1.8rem;
            font-weight: bold;
            margin-bottom: 20px;
            text-transform: uppercase;
            background: linear-gradient(45deg, #e74c3c, #c0392b);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .process-table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 30px;
            background: white;
            border-radius: 10px;
            overflow: hidden;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
        }

        .process-table th, .process-table td {
            padding: 12px;
            text-align: center;
            border: 1px solid #ddd;
        }

        .process-table th {
            background: linear-gradient(45deg, #c0392b, #a93226);
            color: white;
            font-weight: 600;
        }

        .process-table tr:nth-child(even) {
            background-color: #f8f9fa;
        }

        .execution-order {
            background: #e8f4fd;
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 20px;
            border: 2px solid #3498db;
        }

        .execution-order h3 {
            color: #2980b9;
            margin-bottom: 15px;
        }

        .steps {
            margin-bottom: 30px;
        }

        .step {
            background: #f8f9fa;
            padding: 15px;
            margin-bottom: 15px;
            border-radius: 10px;
            border-left: 4px solid #17a2b8;
        }

        .step h4 {
            color: #2c3e50;
            margin-bottom: 10px;
            font-size: 16px;
        }

        .calculation {
            background: #fff3cd;
            padding: 20px;
            border-radius: 10px;
            margin: 20px 0;
            border: 2px solid #ffeaa7;
        }

        .calculation h3 {
            color: #856404;
            margin-bottom: 15px;
        }

        .formula {
            font-family: 'Courier New', monospace;
            font-size: 16px;
            color: #495057;
            margin: 10px 0;
            padding: 10px;
            background: #f8f9fa;
            border-radius: 5px;
            border-left: 4px solid #28a745;
        }

        .gantt-chart {
            overflow-x: auto;
            margin: 20px 0;
            padding: 20px;
            background: #f8f9fa;
            border-radius: 10px;
            border: 2px solid #dee2e6;
        }

        .timeline {
            display: flex;
            min-width: 800px;
            height: 80px;
            border: 2px solid #ddd;
            border-radius: 8px;
            overflow: hidden;
            margin-top: 10px;
        }

        .process-block {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
            border-right: 2px solid #fff;
            min-width: 60px;
            font-size: 14px;
            text-align: center;
        }

        .timeline-labels {
            display: flex;
            min-width: 800px;
            margin-top: 5px;
            font-size: 12px;
            color: #666;
        }

        .time-label {
            min-width: 60px;
            text-align: center;
            border-right: 1px solid #ddd;
        }

        .metrics {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }

        .metric-card {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 20px;
            border-radius: 15px;
            text-align: center;
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.1);
        }

        .metric-value {
            font-size: 2rem;
            font-weight: bold;
            margin-bottom: 5px;
        }

        .metric-label {
            font-size: 14px;
            opacity: 0.9;
        }

        .results-table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
            background: white;
            border-radius: 10px;
            overflow: hidden;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
        }

        .results-table th, .results-table td {
            padding: 12px;
            text-align: center;
            border-bottom: 1px solid #ddd;
        }

        .results-table th {
            background: linear-gradient(45deg, #3498db, #2980b9);
            color: white;
            font-weight: 600;
        }

        .results-table tr:nth-child(even) {
            background-color: #f8f9fa;
        }

        .rr-table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
            background: white;
            border-radius: 10px;
            overflow: hidden;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
            font-size: 14px;
        }

        .rr-table th, .rr-table td {
            padding: 8px;
            text-align: center;
            border: 1px solid #ddd;
        }

        .rr-table th {
            background: linear-gradient(45deg, #c0392b, #a93226);
            color: white;
            font-weight: 600;
        }

        .rr-table .finished {
            background-color: #d4edda !important;
            color: #155724;
            font-weight: bold;
        }

        .hidden {
            display: none;
        }

        @media (max-width: 768px) {
            .container {
                padding: 20px;
                margin: 10px;
            }

            h1 {
                font-size: 2rem;
            }

            .algorithm-selector {
                flex-direction: column;
                align-items: center;
            }

            .algorithm-btn {
                width: 100%;
                max-width: 250px;
            }

            .input-row {
                grid-template-columns: 1fr;
            }

            .controls {
                flex-direction: column;
                align-items: center;
            }

            .btn {
                width: 100%;
                max-width: 250px;
            }

            .metrics {
                grid-template-columns: 1fr;
            }

            .timeline, .timeline-labels {
                min-width: 500px;
            }
        }

        @media (max-width: 480px) {
            .container {
                padding: 15px;
                margin: 5px;
            }

            h1 {
                font-size: 1.8rem;
            }

            .input-section, .results {
                padding: 15px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üîÑ Calculadora de Algoritmos de Planificaci√≥n</h1>
        
        <div class="algorithm-selector">
            <button class="algorithm-btn active" data-algorithm="fcfs">FCFS (First Come First Served)</button>
            <button class="algorithm-btn" data-algorithm="sjf">SJF (Shortest Job First)</button>
            <button class="algorithm-btn" data-algorithm="priority">Por Prioridad</button>
            <button class="algorithm-btn" data-algorithm="rr">Round Robin</button>
        </div>

        <div class="input-section">
            <div class="input-row">
                <div class="input-group">
                    <label for="processName">Nombre del Proceso:</label>
                    <input type="text" id="processName" placeholder="P1, P2, etc.">
                </div>
                <div class="input-group">
                    <label for="arrivalTime">Tiempo de Llegada:</label>
                    <input type="number" id="arrivalTime" min="0" value="0">
                </div>
                <div class="input-group">
                    <label for="burstTime">Tiempo de R√°faga:</label>
                    <input type="number" id="burstTime" min="1" placeholder="Tiempo">
                </div>
                <div class="input-group priority-input hidden">
                    <label for="priority">Prioridad:</label>
                    <input type="number" id="priority" min="1" placeholder="Prioridad">
                </div>
                <div class="input-group rr-input hidden">
                    <label for="quantum">Quantum:</label>
                    <input type="number" id="quantum" min="1" value="5">
                </div>
            </div>
            
            <div class="controls">
                <button class="btn btn-primary" onclick="addProcess()">‚ûï Agregar Proceso</button>
                <button class="btn btn-danger" onclick="clearProcesses()">üóëÔ∏è Limpiar Todo</button>
            </div>

            <div class="process-list" id="processList"></div>
        </div>

        <div class="controls">
            <button class="btn btn-secondary" onclick="calculateScheduling()">üöÄ Calcular Planificaci√≥n</button>
        </div>

        <div class="results hidden" id="results"></div>
    </div>

    <script>
        let processes = [];
        let currentAlgorithm = 'fcfs';

        // Cargar ejemplo autom√°ticamente
        window.onload = function() {
            loadExample();
        };

        function loadExample() {
            processes = [
                { name: 'P1', arrivalTime: 0, burstTime: 10, priority: 2, remainingTime: 10 },
                { name: 'P2', arrivalTime: 0, burstTime: 15, priority: 1, remainingTime: 15 },
                { name: 'P3', arrivalTime: 0, burstTime: 5, priority: 3, remainingTime: 5 },
                { name: 'P4', arrivalTime: 0, burstTime: 20, priority: 1, remainingTime: 20 }
            ];
            updateProcessList();
        }

        // Manejo de selecci√≥n de algoritmo
        document.querySelectorAll('.algorithm-btn').forEach(btn => {
            btn.addEventListener('click', () => {
                document.querySelectorAll('.algorithm-btn').forEach(b => b.classList.remove('active'));
                btn.classList.add('active');
                currentAlgorithm = btn.dataset.algorithm;
                updateInputVisibility();
            });
        });

        function updateInputVisibility() {
            const priorityInput = document.querySelector('.priority-input');
            const rrInput = document.querySelector('.rr-input');
            
            priorityInput.classList.toggle('hidden', currentAlgorithm !== 'priority');
            rrInput.classList.toggle('hidden', currentAlgorithm !== 'rr');
        }

        function addProcess() {
            const name = document.getElementById('processName').value || `P${processes.length + 1}`;
            const arrivalTime = parseInt(document.getElementById('arrivalTime').value) || 0;
            const burstTime = parseInt(document.getElementById('burstTime').value);
            const priority = parseInt(document.getElementById('priority').value) || 1;

            if (!burstTime || burstTime <= 0) {
                alert('Por favor ingrese un tiempo de r√°faga v√°lido');
                return;
            }

            const process = {
                name,
                arrivalTime,
                burstTime,
                priority,
                remainingTime: burstTime
            };

            processes.push(process);
            updateProcessList();
            clearInputs();
        }

        function clearInputs() {
            document.getElementById('processName').value = '';
            document.getElementById('arrivalTime').value = '0';
            document.getElementById('burstTime').value = '';
            document.getElementById('priority').value = '';
        }

        function updateProcessList() {
            const list = document.getElementById('processList');
            list.innerHTML = processes.map((p, index) => `
                <div class="process-item">
                    <strong>${p.name}</strong> - 
                    Llegada: ${p.arrivalTime}, 
                    Tiempo: ${p.burstTime}
                    ${currentAlgorithm === 'priority' ? `, Prioridad: ${p.priority}` : ''}
                    <button style="float: right; background: #e74c3c; color: white; border: none; padding: 5px 10px; border-radius: 5px; cursor: pointer;" onclick="removeProcess(${index})">‚ùå</button>
                </div>
            `).join('');
        }

        function removeProcess(index) {
            processes.splice(index, 1);
            updateProcessList();
        }

        function clearProcesses() {
            processes = [];
            updateProcessList();
            document.getElementById('results').classList.add('hidden');
        }

        function calculateScheduling() {
            if (processes.length === 0) {
                alert('Por favor agregue al menos un proceso');
                return;
            }

            let result;
            switch (currentAlgorithm) {
                case 'fcfs':
                    result = calculateFCFS();
                    break;
                case 'sjf':
                    result = calculateSJF();
                    break;
                case 'priority':
                    result = calculatePriority();
                    break;
                case 'rr':
                    const quantum = parseInt(document.getElementById('quantum').value) || 5;
                    result = calculateRR(quantum);
                    break;
            }

            displayResults(result);
        }

        function calculateFCFS() {
            const processOrder = [...processes].sort((a, b) => a.arrivalTime - b.arrivalTime);
            const timeline = [];
            const waitTimes = [];
            let currentTime = 0;

            // Crear tabla de llegada y tiempos de espera
            processOrder.forEach((process, index) => {
                if (currentTime < process.arrivalTime) {
                    currentTime = process.arrivalTime;
                }

                const startTime = currentTime;
                const endTime = currentTime + process.burstTime;
                const waitTime = startTime - process.arrivalTime;
                
                timeline.push({
                    process: process.name,
                    start: startTime,
                    end: endTime,
                    duration: process.burstTime
                });

                waitTimes.push({
                    name: process.name,
                    arrivalTime: process.arrivalTime,
                    burstTime: process.burstTime,
                    startTime: startTime,
                    endTime: endTime,
                    waitTime: waitTime,
                    turnaroundTime: endTime - process.arrivalTime
                });

                currentTime = endTime;
            });

            return {
                algorithm: 'FCFS (FIRST-COME, FIRST-SERVE)',
                subtitle: 'PRIMERO EN LLEGAR PRIMERO EN SER SERVIDO',
                processes: processOrder,
                timeline,
                waitTimes,
                showOrderTable: true
            };
        }

        function calculateSJF() {
            const remaining = [...processes];
            const timeline = [];
            const waitTimes = [];
            let currentTime = 0;
            const completed = [];

            // Ordenar por tiempo de r√°faga (trabajo m√°s corto primero)
            const sortedByBurst = [...remaining].sort((a, b) => a.burstTime - b.burstTime);
            
            sortedByBurst.forEach((process) => {
                if (currentTime < process.arrivalTime) {
                    currentTime = process.arrivalTime;
                }

                const startTime = currentTime;
                const endTime = currentTime + process.burstTime;
                const waitTime = startTime - process.arrivalTime;
                
                timeline.push({
                    process: process.name,
                    start: startTime,
                    end: endTime,
                    duration: process.burstTime
                });

                waitTimes.push({
                    name: process.name,
                    arrivalTime: process.arrivalTime,
                    burstTime: process.burstTime,
                    startTime: startTime,
                    endTime: endTime,
                    waitTime: waitTime,
                    turnaroundTime: endTime - process.arrivalTime
                });

                completed.push(process);
                currentTime = endTime;
            });

            return {
                algorithm: 'SJF (SHORTEST-JOB-FIRST)',
                subtitle: 'TRABAJO MAS CORTO PRIMERO',
                processes: sortedByBurst,
                timeline,
                waitTimes,
                showOrderTable: true
            };
        }

        function calculatePriority() {
            // Ordenar por prioridad (menor n√∫mero = mayor prioridad)
            const sortedByPriority = [...processes].sort((a, b) => a.priority - b.priority);
            const timeline = [];
            const waitTimes = [];
            let currentTime = 0;

            sortedByPriority.forEach((process) => {
                if (currentTime < process.arrivalTime) {
                    currentTime = process.arrivalTime;
                }

                const startTime = currentTime;
                const endTime = currentTime + process.burstTime;
                const waitTime = startTime - process.arrivalTime;
                
                timeline.push({
                    process: process.name,
                    start: startTime,
                    end: endTime,
                    duration: process.burstTime
                });

                waitTimes.push({
                    name: process.name,
                    arrivalTime: process.arrivalTime,
                    burstTime: process.burstTime,
                    priority: process.priority,
                    startTime: startTime,
                    endTime: endTime,
                    waitTime: waitTime,
                    turnaroundTime: endTime - process.arrivalTime
                });

                currentTime = endTime;
            });

            return {
                algorithm: 'POR PRIORIDAD',
                subtitle: '',
                processes: sortedByPriority,
                timeline,
                waitTimes,
                showOrderTable: true,
                showPriority: true
            };
        }

        function calculateRR(quantum) {
            const queue = [...processes];
            const timeline = [];
            const waitTimes = [];
            const rrDetails = [];
            let currentTime = 0;
            let round = 1;

            // Inicializar tiempos restantes
            queue.forEach(p => p.remainingTime = p.burstTime);

            while (queue.some(p => p.remainingTime > 0)) {
                for (let i = 0; i < queue.length; i++) {
                    const process = queue[i];
                    if (process.remainingTime <= 0) continue;

                    const executeTime = Math.min(quantum, process.remainingTime);
                    const startTime = currentTime;
                    const endTime = currentTime + executeTime;

                    timeline.push({
                        process: process.name,
                        start: startTime,
                        end: endTime,
                        duration: executeTime
                    });

                    rrDetails.push({
                        round: round,
                        process: process.name,
                        arrivalTime: startTime,
                        executeTime: executeTime,
                        waitTime: startTime - process.arrivalTime,
                        remainingTime: process.remainingTime - executeTime
                    });

                    process.remainingTime -= executeTime;
                    currentTime = endTime;

                    if (process.remainingTime === 0) {
                        waitTimes.push({
                            name: process.name,
                            arrivalTime: process.arrivalTime,
                            burstTime: process.burstTime,
                            finishTime: endTime,
                            waitTime: endTime - process.arrivalTime - process.burstTime,
                            turnaroundTime: endTime - process.arrivalTime
                        });
                    }
                }
                round++;
            }

            return {
                algorithm: 'ROUND-ROBIN (RR)',
                subtitle: `QUANTUM = ${quantum}`,
                processes: processes,
                timeline,
                waitTimes,
                rrDetails,
                quantum,
                showRRTable: true
            };
        }

        function displayResults(result) {
            const resultsDiv = document.getElementById('results');
            resultsDiv.classList.remove('hidden');
            
            let html = `
                <div class="algorithm-title">${result.algorithm}</div>
                ${result.subtitle ? `<div style="text-align: center; font-size: 1.2rem; color: #2c3e50; margin-bottom: 30px; font-weight: 600;">${result.subtitle}</div>` : ''}
            `;

            // Tabla de procesos inicial
            html += `
                <table class="process-table">
                    <thead>
                        <tr>
                            <th>Procesos</th>
                            <th>Tiempo</th>
                            ${result.showPriority ? '<th>Prioridad</th>' : ''}
                        </tr>
                    </thead>
                    <tbody>
                        ${processes.map(p => `
                            <tr>
                                <td>${p.name}</td>
                                <td>${p.burstTime}</td>
                                ${result.showPriority ? `<td>${p.priority}</td>` : ''}
                            </tr>
                        `).join('')}
                    </tbody>
                </table>
            `;

            // Tabla de orden de ejecuci√≥n o Round Robin
            if (result.showOrderTable) {
                html += `
                    <div class="execution-order">
                        <h3>Orden de Ejecuci√≥n y Tiempos de Espera</h3>
                        <table class="process-table">
                            <thead>
                                <tr>
                                    <th>Llegada</th>
                                    ${result.waitTimes.map(p => `<th>${p.name}</th>`).join('')}
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>Tiempo</td>
                                    ${result.waitTimes.map(p => `<td>${p.burstTime}</td>`).join('')}
                                </tr>
                                <tr>
                                    <td>Espera</td>
                                    ${result.waitTimes.map(p => `<td>${p.waitTime}</td>`).join('')}
                                </tr>
                                ${result.showPriority ? `<tr><td>Prioridad</td>${result.waitTimes.map(p => `<td>${p.priority}</td>`).join('')}</tr>` : ''}
                            </tbody>
                        </table>
                    </div>
                `;
            }

            // Tabla especial para Round Robin
            if (result.showRRTable) {
                html += `
                    <div class="execution-order">
                        <h3>Detalle de Ejecuci√≥n Round Robin</h3>
                        <table class="rr-table">
                            <thead>
                                <tr>
                                    <th>Llegada</th>
                                    ${result.rrDetails.map((detail, index) => `<th>${detail.process}</th>`).join('')}
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>Tiempo</td>
                                    ${result.rrDetails.map(detail => `<td>${detail.executeTime}</td>`).join('')}
                                </tr>
                                <tr>
                                    <td>Espera</td>
                                    ${result.rrDetails.map(detail => `<td>${detail.waitTime}</td>`).join('')}
                                </tr>
                                <tr>
                                    <td>Ronda</td>
                                    ${result.rrDetails.map(detail => `<td>${detail.round}</td>`).join('')}
                                </tr>
                                <tr>
                                    <td>TRestante</td>
                                    ${result.rrDetails.map(detail => `<td ${detail.remainingTime === 0 ? 'class="finished"' : ''}>${detail.remainingTime === 0 ? '‚úï' : detail.remainingTime}</td>`).join('')}
                                </tr>
                            </tbody>
                        </table>
                    </div>
                `;
            }

            // Diagrama de Gantt
            html += `
                <div class="gantt-chart">
                    <h3>üìà Diagrama de Gantt</h3>
                    <div class="timeline" id="timeline"></div>
                    <div class="timeline-labels" id="timelineLabels"></div>
                </div>
            `;

            // C√°lculos de tiempo promedio de espera
            const totalWaitTime = result.waitTimes.reduce((sum, p) => sum + p.waitTime, 0);
            const avgWaitTime = (totalWaitTime / result.waitTimes.length).toFixed(2);
            const totalTurnaroundTime = result.waitTimes.reduce((sum, p) => sum + p.turnaroundTime, 0);
            const avgTurnaroundTime = (totalTurnaroundTime / result.waitTimes.length).toFixed(2);

            html += `
                <div class="calculation">
                    <h3>üßÆ C√°lculo del Tiempo Promedio de Espera</h3>
                    <div class="formula">Tp = (Tp1 + Tp2 + Tp3 + Tp4) / Ntp</div>
                    <div class="formula">Tp = Tiempo de ESPERA</div>
                    <div class="formula">Ntp = N Tiempos de Espera</div>
                    <div class="formula">Tp = ${result.waitTimes.map(p => p.waitTime).join(' + ')} / ${result.waitTimes.length}</div>
                    <div class="formula">Tp = ${totalWaitTime} / ${result.waitTimes.length} = ${avgWaitTime}</div>
                </div>
            `;

            // M√©tricas
            html += `
                <div class="metrics">
                    <div class="metric-card">
                        <div class="metric-value">${avgWaitTime}</div>
                        <div class="metric-label">Tiempo Promedio de Espera</div>
                    </div>
                    <div class="metric-card">
                        <div class="metric-value">${avgTurnaroundTime}</div>
                        <div class="metric-label">Tiempo Promedio de Retorno</div>
                    </div>
                    <div class="metric-card">
                        <div class="metric-value">${Math.max(...result.timeline.map(t => t.end))}</div>
                        <div class="metric-label">Tiempo Total de Ejecuci√≥n</div>
                    </div>
                </div>
            `;

            // Tabla de resultados finales
            html += `
                <table class="results-table">
                    <thead>
                        <tr>
                            <th>Proceso</th>
                            <th>Tiempo de Llegada</th>
                            <th>Tiempo de R√°faga</th>
                            <th>Tiempo de Finalizaci√≥n</th>
                            <th>Tiempo de Retorno</th>
                            <th>Tiempo de Espera</th>
                        </tr>
                    </thead>
                    <tbody>
                        ${result.waitTimes.map(p => `
                            <tr>
                                <td>${p.name}</td>
                                <td>${p.arrivalTime}</td>
                                <td>${p.burstTime}</td>
                                <td>${p.finishTime || p.endTime}</td>
                                <td>${p.turnaroundTime}</td>
                                <td>${p.waitTime}</td>
                            </tr>
                        `).join('')}
                    </tbody>
                </table>
            `;

            resultsDiv.innerHTML = html;

            // Mostrar diagrama de Gantt
            setTimeout(() => {
                displayGanttChart(result.timeline);
            }, 100);
        }

        function displayGanttChart(timeline) {
            const timelineDiv = document.getElementById('timeline');
            const timelineLabelsDiv = document.getElementById('timelineLabels');
            const colors = ['#3498db', '#e74c3c', '#2ecc71', '#f39c12', '#9b59b6', '#1abc9c', '#e67e22', '#34495e'];
            
            // Crear bloques del diagrama de Gantt
            timelineDiv.innerHTML = timeline.map((item, index) => {
                const color = colors[processes.findIndex(p => p.name === item.process) % colors.length];
                const width = Math.max(item.duration * 40, 60); // Ancho m√≠nimo de 60px
                return `
                    <div class="process-block" style="
                        background-color: ${color};
                        width: ${width}px;
                    ">
                        <div>${item.process}</div>
                        <small>${item.start}-${item.end}</small>
                    </div>
                `;
            }).join('');

            // Crear etiquetas de tiempo
            const maxTime = Math.max(...timeline.map(t => t.end));
            const timePoints = [];
            
            // Agregar puntos de tiempo importantes
            timeline.forEach(t => {
                if (!timePoints.includes(t.start)) timePoints.push(t.start);
                if (!timePoints.includes(t.end)) timePoints.push(t.end);
            });
            timePoints.sort((a, b) => a - b);
            
            let labels = '';
            timePoints.forEach(time => {
                labels += `<div class="time-label" style="width: ${Math.max(40, 60)}px;">${time}</div>`;
            });
            timelineLabelsDiv.innerHTML = labels;
        }
    </script>
</body>
</html>